<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
  layout:decorate="~{layout/default_layout}">
<th:block layout:fragment="head">
  <meta charset="UTF-8">
  <title>ì˜ˆì•½</title>
  <link th:href="@{/css/header.css}" rel="stylesheet" />
  <link th:href="@{/css/reservationForm.css}" rel="stylesheet" />
  <link th:href="@{/css/footer.css}" rel="stylesheet" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/fullcalendar@5.10.1/main.css">
  <script src="https://cdn.jsdelivr.net/npm/fullcalendar@5.10.1/main.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.18.1/moment.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/fullcalendar@5.10.1/locales-all.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Yellowtail&display=swap" rel="stylesheet">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBWxzUNzX_Sy9rtcbIxP0WhUfXSBGNqzU4&v=3.exp&region=KR"></script>
  <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
  <link rel="stylesheet" href="http://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
  <script src="https://code.jquery.com/jquery-1.12.4.js"></script>
  <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
  
  <script th:inline="javascript">
    var today = new Date();
		var year = today.getFullYear();
		var profId = [[${ profId }]];
		var consultableTimes = [[${ consultableTimes }]];
		var reservations = [[${ reservations }]];
		var coordinates = [[${ coordinates }]];
		var reservationInfo = [[${ reservation }]]; // ìˆ˜ì •í•  ì˜ˆì•½ì •ë³´

		$(function() {
			$("#choiceDate").datepicker({
				dateFormat: 'yy-mm-dd' //ë‹¬ë ¥ ë‚ ì§œ í˜•íƒœ
					,yearRange: year + ":" + (year + 1)
					,showOtherMonths: true //ë¹ˆ ê³µê°„ì— í˜„ì¬ì›”ì˜ ì•ë’¤ì›”ì˜ ë‚ ì§œë¥¼ í‘œì‹œ
					,showMonthAfterYear:true // ì›”- ë…„ ìˆœì„œê°€ì•„ë‹Œ ë…„ë„ - ì›” ìˆœì„œ
		            ,changeYear: true //optionê°’ ë…„ ì„ íƒ ê°€ëŠ¥
		            ,changeMonth: true //optionê°’  ì›” ì„ íƒ ê°€ëŠ¥                       
		            ,yearSuffix: "ë…„" //ë‹¬ë ¥ì˜ ë…„ë„ ë¶€ë¶„ ë’¤ í…ìŠ¤íŠ¸
		            ,monthNamesShort: ['1ì›”','2ì›”','3ì›”','4ì›”','5ì›”','6ì›”','7ì›”','8ì›”','9ì›”','10ì›”','11ì›”','12ì›”'] //ë‹¬ë ¥ì˜ ì›” ë¶€ë¶„ í…ìŠ¤íŠ¸
		            ,monthNames: ['1ì›”','2ì›”','3ì›”','4ì›”','5ì›”','6ì›”','7ì›”','8ì›”','9ì›”','10ì›”','11ì›”','12ì›”'] //ë‹¬ë ¥ì˜ ì›” ë¶€ë¶„ Tooltip
		            ,dayNamesMin: ['ì¼','ì›”','í™”','ìˆ˜','ëª©','ê¸ˆ','í† '] //ë‹¬ë ¥ì˜ ìš”ì¼ í…ìŠ¤íŠ¸
		            ,dayNames: ['ì¼ìš”ì¼','ì›”ìš”ì¼','í™”ìš”ì¼','ìˆ˜ìš”ì¼','ëª©ìš”ì¼','ê¸ˆìš”ì¼','í† ìš”ì¼'] //ë‹¬ë ¥ì˜ ìš”ì¼ Tooltip
		            ,minDate: "+1D" //ìµœì†Œ ì„ íƒì¼ì(-1D:í•˜ë£¨ì „, -1M:í•œë‹¬ì „, -1Y:ì¼ë…„ì „)
		            ,maxDate: "+30D" //ìµœëŒ€ ì„ íƒì¼ì(+1D:í•˜ë£¨í›„, -1M:í•œë‹¬í›„, -1Y:ì¼ë…„í›„)
		            ,beforeShowDay: disableAllTheseDays
		            ,onSelect: calendarChoiceDate
			});                    
			
			// ì˜ˆì•½ì •ë³´ê°€ ìˆë‹¤ë©´ ì˜ˆì•½ì¼ì„ ì„ íƒí•˜ë„ë¡ ì„¤ì •
			if (reservationInfo != null) {
				$('#choiceDate').datepicker('setDate', reservationInfo['startDate']);
				calendarChoiceDate();
			}
		});
		
		// íŠ¹ì •ì¼ ì„ íƒë§‰ê¸°
		var disabledDays = [];
		var flag;
		for (var i = 0; i < 7; i++) {
			flag = 1;
			for (key in consultableTimes) {
				if (consultableTimes[key].ableDate == i) {
					flag = 0;
				}
			}
			if (flag == 1) {
				disabledDays.push(i);
			}
		}
	    
    function disableAllTheseDays(date) {
        for (var i = 0; i < disabledDays.length; i++) {
            if($.inArray(date.getDay(), disabledDays) != -1) {
                return [false];
            }
        }
        return [true];
    }
  </script>
  
  <style>
		#officeMapWrap {
			margin-top: 40px;
		}
		
		#officeMapTit {
			display: flex;
			align-items: center;
			padding-left: 20px;
			font-size: 14px;
			height: 40px;
			background-color: white;
			border: 1px solid #EAEAEA;
		}
		
		#office_map {
			border: 1px solid #EAEAEA;
		}
		
		#pickPeriodInner {
			width: 100%;
			text-align: center;
		}
		
		#choiceDate {
			width: 208px;
			text-align: center;
			border: none;
			cursor: pointer;
		}
		
		#navWrap {
		    padding-top: 80px;
		    display: flex;
		    justify-content: space-between;
		    margin: 0 auto;
		    width: 1194px;
		    height: 1200px;
		}
		
		.reservationBtn {
		    margin-top: 20px;
		    margin-left: 20px;
		    float: right;
		    display: block;
		    padding: 10px 20px;
		    border-radius: 5px;
		    color: #1abc9c;
		    background-color: white;
		    border: none;
		    border: 1px solid #1abc9c;
		}
	</style>
</th:block>

<body>
<th:block layout:fragment="header" th:include="@{/fragments/header}"></th:block>
	<form action="reservate" method="post" name="reservation_form" onsubmit="return ck_reservation_form()">
		<input type="hidden" name="profId" th:value="${profId}">
		<div id="navWrap">
			<div id="navL">
				<div id="navLTit">ìƒë‹´ì˜ˆì•½</div>
				<div id="navListWrap">
					<div class="navListName">êµìˆ˜ëª…</div>
					<div th:text="${professorInfo.member.name}" class="navList" id="name">êµìˆ˜ëª…</div>
					<div class="navListName">í•™ê³¼</div>
					<div th:text="${professorInfo.member.deptInfo.deptName}" class="navList" id="dept">í•™ê³¼</div>
					<div class="navListName">ì „ê³µ</div>
					<div th:text="${professorInfo.major}" class="navList" id="major">ì „ê³µ</div>
					<div class="navListName">ë‹´ë‹¹ê³¼ëª©</div>
					<div th:each="course : ${professorInfo.courses}" th:text="${course.title}" class="navList" id="course">ë‹´ë‹¹ê³¼ëª©</div>
					<div class="navListName">ì´ë©”ì¼</div>
					<div th:text="${professorInfo.member.email}" class="navList" id="email">ì´ë©”ì¼</div>
					<div class="navListName">ì—°êµ¬ì‹¤ ìœ„ì¹˜</div>
					<div th:text="${professorInfo.officeNo}" class="navList" id="office">ì—°êµ¬ì‹¤ ìœ„ì¹˜</div>
				</div>
				
				<div id="officeMapWrap">
					<div id="officeMapTit">ì—°êµ¬ì‹¤ ìœ„ì¹˜ ì§€ë„</div>
					<div id="office_map"></div>
				</div>
			</div>

			<div id="navR">
				<div id="navRTit">ìƒë‹´ ë‚ ì§œ ì„ íƒ</div>
				<div id="navRContentWrap">
					<div id="pickPeriodWrap">
		                <div id="pickPeriodInner">
		                    <input type="text" name="choiceDate" id="choiceDate" placeholder="ğŸ—“ ì›í•˜ì‹œëŠ” ë‚ ì§œë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”." onfocus="this.blur()" />
		                </div>
	            	</div>
				</div>

				<div id="navRTit">ìƒë‹´ ì‹œê°„ ì„ íƒ</div>
				<div id="navRContentWrap">
					<div id="timeBoxesWrap">
						<div class="timeTitle" id="startTimeTitle">
							<span style="color: #1abc9c;">â—ˆ</span> ìƒë‹´ ì‹œì‘ ì‹œê°„
						</div>
						<div>
							<div class="timeBoxWrap">
								<div class="startTimeBox" id="09:00">
									<a>09:00</a>
								</div>
								<div class="startTimeBox" id="10:00">
									<a>10:00</a>
								</div>
								<div class="startTimeBox" id="11:00">
									<a>11:00</a>
								</div>
							</div>
							<div class="timeBoxWrap">
								<div class="startTimeBox" id="12:00">
									<a>12:00</a>
								</div>
								<div class="startTimeBox" id="13:00">
									<a>13:00</a>
								</div>
								<div class="startTimeBox" id="14:00">
									<a>14:00</a>
								</div>
							</div>
							<div class="timeBoxWrap">
								<div class="startTimeBox" id="15:00">
									<a>15:00</a>
								</div>
								<div class="startTimeBox" id="16:00">
									<a>16:00</a>
								</div>
								<div class="startTimeBox" id="17:00">
									<a>17:00</a>
								</div>
							</div>
						</div>
						<br />
						<div class="timeTitle" id="timeTitle">
							<span style="color: #1abc9c;">â—ˆ</span> ìƒë‹´ ì‹œê°„
						</div>
						<div class="timeBoxWrap">
							<div class="timeBox" id="1h">
								<a>1ì‹œê°„</a>
							</div>
							&nbsp;&nbsp;
							<div class="timeBox" id="2h">
								<a>2ì‹œê°„</a>
							</div>
						</div>
					</div>
				</div>

				<div id="navRTit">ìƒë‹´ ì‹ ì²­ ì‚¬ìœ </div>
				<div id="navRContentWrap">
					<div id="reasonWrap">
						<div>
							<input id="radio1" type="radio" name="radio" value="1"
								checked="checked"><label for="radio1">ì „ë‹´ êµìˆ˜ ìƒë‹´</label>
						</div>
						<div>
							<input id="radio2" type="radio" name="radio" value="2"><label
								for="radio2">ì§„ë¡œ ìƒë‹´</label>
						</div>
						<div>
							<input id="radio3" type="radio" name="radio" value="3"><label
								for="radio3">íœ´í•™ ìƒë‹´</label>
						</div>
						<div>
							<input id="radio4" type="radio" name="radio" value="4"><label
								for="radio4">ëŒ€í•™ì› ìƒë‹´</label>
						</div>
						<div>
							<input id="radio5" type="radio" name="radio" value="5"><label
								for="radio5">ê¸°íƒ€:</label> <input type="text"
								placeholder="ë‚´ìš©ì„ ì ì–´ì£¼ì„¸ìš”." id="anotherReason">
						</div>
					</div>
				</div>

				<div id="navRTit">ìƒë‹´ ìœ í˜•</div>
				<div id="navRContentWrap">
					<div class="typeBtnWrap">
						<div id="typeBtnOff" class="typeBtn"><a>ì˜¤í”„ë¼ì¸</a></div>
						<div id="typeBtnOn" class="typeBtn"><a>ì˜¨ë¼ì¸</a></div>
					</div>
				</div>

				<div>
					<input class="reservationBtn" type="submit" value="ì˜ˆì•½í•˜ê¸°" />
				</div>
				<div id="blank"></div>
			</div>
		</div>
	</form>
	<th:block layout:fragment="footer" th:include="@{/fragments/footer}"></th:block>
	
	<script src="/javascript/reservationForm.js"></script>
	<script src="/javascript/alert.js"></script>
</body>
</html>